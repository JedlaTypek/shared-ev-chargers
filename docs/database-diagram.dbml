Table users [headercolor: #175e7a] {
	id serial [ pk ]
	email varchar(255) [ not null, unique ]
	password_hash text [ not null ]
	full_name varchar(255)
	role varchar(20) [ default: 'user' ]
	balance numeric(10,2) [ default: 0 ]
	created_at timestamp [ default: `NOW()` ]
}

Table chargers [headercolor: #175e7a] {
	id serial [ pk ]
	owner_id integer [ not null ]
	name varchar(255) [ not null ]
	latitude numeric(9,6) [ not null ]
	longitude numeric(9,6) [ not null ]
	street varchar(255)
	house_number varchar(20)
	city varchar(100)
	postal_code varchar(20)
	region varchar(100)
	ocpp_id varchar(255) [ unique ]
	is_active boolean [ default: true ]
	created_at timestamp [ default: `NOW()` ]
}

Table connector_types [headercolor: #175e7a] {
	id serial [ pk ]
	name varchar(50) [ not null, unique ]
	current_type varchar(10) [ not null ]
}

Table connectors [headercolor: #175e7a] {
	id serial [ pk ]
	charger_id integer [ not null ]
	connector_type_id integer [ not null ]
	connector_number integer [ not null ]
	max_power_kw numeric(5,2) [ not null ]
	price_per_kwh numeric(5,2) [ not null ]
	is_active boolean [ default: true ]
}

Table rfid_cards [headercolor: #175e7a] {
	id serial [ pk ]
	user_id integer [ not null ]
	card_uid varchar(255) [ not null, unique ]
	is_active boolean [ default: true ]
	created_at timestamp [ default: `NOW()` ]
}

Table charge_logs [headercolor: #175e7a] {
	id serial [ pk ]
	user_id integer
	charger_id integer
	connector_id integer
	rfid_card_id integer
	start_time timestamp [ not null ]
	end_time timestamp
	energy_kwh numeric(8,3)
	price numeric(7,2)
	status varchar(20) [ default: 'running' ]
}

Table reservations [headercolor: #175e7a] {
	id serial [ pk ]
	user_id integer [ not null ]
	charger_id integer [ not null ]
	connector_id integer
	start_time timestamp [ not null ]
	end_time timestamp [ not null ]
	status varchar(20) [ default: 'active' ]
}

Ref fk_chargers_owner_id_users {
	chargers.owner_id > users.id [ delete: cascade, update: no action ]
}

Ref fk_connectors_charger_id_chargers {
	connectors.charger_id > chargers.id [ delete: cascade, update: no action ]
}

Ref fk_connectors_connector_type_id_connector_types {
	connectors.connector_type_id > connector_types.id [ delete: restrict, update: no action ]
}

Ref fk_rfid_cards_user_id_users {
	rfid_cards.user_id > users.id [ delete: cascade, update: no action ]
}

Ref fk_charge_logs_user_id_users {
	charge_logs.user_id > users.id [ delete: set null, update: no action ]
}

Ref fk_charge_logs_charger_id_chargers {
	charge_logs.charger_id > chargers.id [ delete: set null, update: no action ]
}

Ref fk_charge_logs_connector_id_connectors {
	charge_logs.connector_id > connectors.id [ delete: set null, update: no action ]
}

Ref fk_charge_logs_rfid_card_id_rfid_cards {
	charge_logs.rfid_card_id > rfid_cards.id [ delete: set null, update: no action ]
}

Ref fk_reservations_user_id_users {
	reservations.user_id > users.id [ delete: cascade, update: no action ]
}

Ref fk_reservations_charger_id_chargers {
	reservations.charger_id > chargers.id [ delete: cascade, update: no action ]
}

Ref fk_reservations_connector_id_connectors {
	reservations.connector_id > connectors.id [ delete: set null, update: no action ]
}